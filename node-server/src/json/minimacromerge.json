{
  "size": 1,
  "fields": [
    "in",
    "out",
    "filesize",
    "fm_date"
  ],
   "sort": {
      "fm_date": "desc"
   },
  "query": {
      "bool":{
        "must":{
          "prefix":{"_id":"run225956"}
        },
        "should":[],
        "minimum_should_match" : 1
      }
  },
  "aggs": {
	  "inrange": {
		  "filter": {
			  "range": {
				  "ls": {
					  "from": "1900",
					  "to": "1920"
				  }
			  }
		  },
		  "aggs": {
			  "ls": {
				  "histogram": {
					  "field": "ls",
					  "interval": 1,
					  "min_doc_count": 0,
					  "extended_bounds": {
						  "min": "1900",
						  "max": "1920"
					  }
				  },
				  "aggs": {
					  "procNoDQM": {
                                                  "filter" : {
                                                         "bool":{
                                                                 "must_not":{ 
                                                                          "prefix": {
                                                                                  "stream":"DQM"
                                                                                  } 
                                                                            }
                                                                }
                                                         },
                                                  "aggs":{
                                                          "processed":{ 
						                 "sum": {
							                "field": "processed"
						                 }
                                                         }
                                                  }
					  },
                                          "procDQMHisto":{
                                            "filter" : {
                                                    "term":{"stream":"DQMHistograms"}
                                            },
                                            "aggs":{
                                                    "processed":{
                                                           "sum": {"field": "processed"}
                                                           }
                                                   }
                                          },
				          "procAll": {
						  "sum": {
							  "field": "processed"
						  }
					  }

				  }
			  }
		  }
	  },


	  "sumbefore": {
		  "filter": {
			  "range": {
				  "ls": {
					  "from": "0",
					  "to": "1"
				  }
			  }
		  },
		  "aggs": {


					  "procNoDQM": {
                                                  "filter" : {
                                                         "bool":{
                                                                 "must_not":{ 
                                                                          "prefix": {
                                                                                  "stream":"DQM"
                                                                                  } 
                                                                            }
                                                                }
                                                         },
                                                  "aggs":{
                                                          "processed":{ 
						                 "sum": {
							                "field": "processed"
						                 }
                                                         }
                                                  }
					  },
                                          "procDQMHisto":{
                                            "filter" : {
                                                    "term":{"stream":"DQMHistograms"}
                                            },
                                            "aggs":{
                                                    "processed":{
                                                           "sum": {"field": "processed"}
                                                           }
                                                   }
                                          },
				          "procAll": {
						  "sum": {
							  "field": "processed"
						  }
					  }



                  }



              }






  }
}
